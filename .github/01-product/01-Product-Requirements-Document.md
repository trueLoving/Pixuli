# Pixuli 产品需求文档（PRD）

- **文档版本**：1.4
- **创建日期**：2025-01-27
- **最后更新**：2025-01-29
- **项目名称**：Pixuli - 智能图片管理应用

---

## 一、文档概述

### 1.1 目的

本文档系统描述 Pixuli 项目的产品需求，包括已实现功能、进行中功能与待实现功能，为产品迭代、开发排期与验收提供依据。

### 1.2 范围

- 产品经理、项目经理：需求理解与排期
- 开发工程师：功能实现与接口设计
- 测试工程师：测试用例设计与验收标准
- 运维与部署：运行环境与约束

### 1.3 术语与缩写

| 术语     | 说明                                          |
| -------- | --------------------------------------------- |
| PRD      | 产品需求文档（Product Requirements Document） |
| PWA      | 渐进式 Web 应用（Progressive Web App）        |
| WASM     | WebAssembly，高性能二进制指令格式             |
| CRUD     | 创建 / 读取 / 更新 / 删除                     |
| Monorepo | 单一代码库管理多个包/应用                     |

---

## 二、项目概述

### 2.1 背景

Pixuli 源于两类需求：

1. **实际需求**：博客与网站运营中统一的图片存储、压缩与批量处理需求。
2. **技术实践**：在已有 Vue3 图片管理应用经验基础上，使用 React 技术栈重新实现，并扩展至多平台（Web、桌面、移动端）。

### 2.2 产品定位

Pixuli 是一款**基于 Monorepo 架构的智能图片管理方案**，支持多平台部署与统一体验：

- **桌面端**：Electron + React，支持 Windows、macOS（含 Apple Silicon）
- **Web**：Vite + React，支持 PWA 与在线访问
- **移动端**：React Native + Expo，支持 Android（iOS 规划中）

**核心价值**：以 GitHub /
Gitee 仓库为存储后端，提供图片浏览、上传、编辑、压缩、格式转换与元数据管理，具备统一云存储与版本控制能力。

### 2.3 目标用户

- 个人博客 / 静态站运营者：需要稳定、可版本化的图床
- 内容创作者：需要批量上传、压缩与格式转换
- 开发者与运维：需要自托管、可集成的图片管理能力

---

## 三、系统架构与技术栈

### 3.1 项目结构

```
Pixuli/
├── apps/
│   ├── pixuli/          # Web + 桌面统一应用（Vite + React + Electron）
│   └── mobile/          # 移动端应用（React Native + Expo）
├── packages/
│   ├── common/          # 跨平台共享组件、Hooks、工具与存储服务
│   └── wasm/             # Rust WASM 图片处理核心（Web/桌面）
├── server/               # 可选后端服务（NestJS + Prisma + MySQL/MinIO）
├── benchmark/            # 性能测试
├── .github/design/       # 设计文档（跨平台资源、图片处理、性能、日志等）
```

### 3.2 技术栈概览

| 层级       | 技术                                 | 说明                               |
| ---------- | ------------------------------------ | ---------------------------------- |
| 前端框架   | React 19.x + TypeScript              | 统一 UI 与逻辑                     |
| 构建工具   | Vite                                 | Web/桌面构建                       |
| 桌面运行时 | Electron                             | 跨平台桌面应用                     |
| 移动端     | React Native + Expo                  | 跨平台移动应用                     |
| 状态管理   | Zustand                              | 轻量状态管理                       |
| 图片处理   | Rust (WASM) / expo-image-manipulator | Web/桌面用 WASM，移动端用原生      |
| 云存储     | GitHub API / Gitee API               | 以仓库为图床                       |
| 可选后端   | NestJS + Prisma + MySQL              | 图片元数据与文件存储（本地/MinIO） |

### 3.3 平台能力矩阵

| 能力                       | Web                | 桌面               | 移动端                                      |
| -------------------------- | ------------------ | ------------------ | ------------------------------------------- |
| 仓库源管理（GitHub/Gitee） | ✅                 | ✅                 | ✅                                          |
| 图片 CRUD                  | ✅                 | ✅                 | ✅（批量上传已完成；批量编辑：⏳ 高优先级） |
| 幻灯片 / 时间线浏览        | ✅                 | ✅                 | ✅（幻灯片已实现）                          |
| 操作日志                   | ✅                 | ✅                 | ✅                                          |
| PWA / 离线                 | ✅                 | ⏳ 待实现          | ⏳ 中优先级                                 |
| 格式转换 / 压缩 / 编辑     | 框架就绪，逻辑待补 | 框架就绪，逻辑待补 | ✅ 部分已实现                               |
| 批量编辑元数据             | ⏳ 待实现          | ⏳ 待实现          | ⏳ 高优先级                                 |
| 布局优化（列数/瀑布流）    | ⏳ 待实现          | ⏳ 待实现          | ⏳ 中优先级                                 |
| 私有仓库访问控制           | ⏳ 待实现          | ⏳ 待实现          | ⏳ 中优先级                                 |
| AI 能力集成                | ⏳ 待实现          | ⏳ 待实现          | ⏳ 低优先级                                 |
| 收藏与分组                 | ⏳ 待实现          | ⏳ 待实现          | ⏳ 低优先级                                 |
| 统计与洞察                 | ⏳ 待实现          | ⏳ 待实现          | ⏳ 低优先级                                 |
| 相机 / 相册                | —                  | —                  | ✅                                          |

---

## 四、功能需求

### 4.1 仓库源管理（已实现）

**概述**：用户可配置多个 GitHub 或 Gitee 仓库作为图片存储源，并可在源之间切换。

#### 4.1.1 功能点

| ID           | 需求                                                           | 优先级 | 状态 | 平台                |
| ------------ | -------------------------------------------------------------- | ------ | ---- | ------------------- |
| F-SOURCE-001 | 支持添加多个 GitHub 仓库源（owner、repo、branch、token、path） | P0     | ✅   | Web / 桌面 / 移动端 |
| F-SOURCE-002 | 支持添加多个 Gitee 仓库源（结构同上）                          | P0     | ✅   | Web / 桌面 / 移动端 |
| F-SOURCE-003 | 支持在已配置源之间切换为当前活跃源                             | P0     | ✅   | 全平台              |
| F-SOURCE-004 | 支持编辑与删除已有仓库源                                       | P0     | ✅   | 全平台              |
| F-SOURCE-005 | 配置持久化（Web/桌面：localStorage；移动端：AsyncStorage）     | P0     | ✅   | 全平台              |
| F-SOURCE-006 | 配置表单校验（必填项、格式等）                                 | P1     | ✅   | 全平台              |
| F-SOURCE-007 | 配置导入、导出与清空                                           | P1     | ✅   | 全平台              |

#### 4.1.2 业务规则

- GitHub 与 Gitee 配置可并存；切换仅改变「当前活跃」的存储服务。
- Token 等敏感信息仅本地持久化，不上传至用户不可控的服务器。

---

### 4.2 图片 CRUD（已实现）

**概述**：在当前选中的仓库源内对图片进行创建、读取、更新与删除。

#### 4.2.1 创建

| ID         | 需求                                         | 优先级 | 状态 | 平台   |
| ---------- | -------------------------------------------- | ------ | ---- | ------ |
| F-CRUD-C01 | 单张图片上传并带元数据（名称、描述、标签等） | P0     | ✅   | 全平台 |
| F-CRUD-C02 | 批量图片上传并显示进度（进度条/百分比）      | P0     | ✅   | 全平台 |
| F-CRUD-C03 | 移动端：支持相机拍摄与相册选择上传           | P0     | ✅   | 移动端 |

#### 4.2.2 读取

| ID         | 需求                                                 | 优先级 | 状态 | 平台   |
| ---------- | ---------------------------------------------------- | ------ | ---- | ------ |
| F-CRUD-R01 | 从当前源加载图片列表                                 | P0     | ✅   | 全平台 |
| F-CRUD-R02 | 以网格/列表形式展示图片                              | P0     | ✅   | 全平台 |
| F-CRUD-R03 | 全屏预览、缩放、左右切换等                           | P0     | ✅   | 全平台 |
| F-CRUD-R04 | 查看单张图片元数据（名称、描述、标签、尺寸、时间等） | P1     | ✅   | 全平台 |
| F-CRUD-R05 | 下拉刷新以同步最新列表                               | P1     | ✅   | 全平台 |
| F-CRUD-R06 | 移动端：元数据缓存以优化加载与离线浏览               | P1     | ✅   | 移动端 |

#### 4.2.3 更新

| ID         | 需求                                           | 优先级 | 状态      | 平台                |
| ---------- | ---------------------------------------------- | ------ | --------- | ------------------- |
| F-CRUD-U01 | 编辑图片元数据（描述、标签等），支持重命名检测 | P0     | ✅        | 全平台              |
| F-CRUD-U02 | 对多张图片批量编辑元数据（标签、描述、名称）   | P1     | ⏳ 待实现 | Web / 桌面 / 移动端 |

#### 4.2.4 删除

| ID         | 需求                     | 优先级 | 状态 | 平台   |
| ---------- | ------------------------ | ------ | ---- | ------ |
| F-CRUD-D01 | 单张图片删除并带确认机制 | P0     | ✅   | 全平台 |
| F-CRUD-D02 | 批量选择与批量删除       | P0     | ✅   | 全平台 |

---

### 4.3 浏览模式（已实现）

**概述**：对同一套图片数据提供三种浏览模式：文件模式、幻灯片与时间线。

| ID          | 需求                                                | 优先级 | 状态 | 平台       |
| ----------- | --------------------------------------------------- | ------ | ---- | ---------- |
| F-BROWSE-01 | 文件模式：网格/列表展示，支持点击预览、图片切换     | P0     | ✅   | Web / 桌面 |
| F-BROWSE-02 | 幻灯片模式：自动/手动播放、过渡动画、循环等         | P0     | ✅   | Web / 桌面 |
| F-BROWSE-03 | 时间线模式：按时间分组展示                          | P0     | ✅   | Web / 桌面 |
| F-BROWSE-04 | 侧边栏菜单切换三种模式并跳转对应页面                | P0     | ✅   | Web / 桌面 |
| F-BROWSE-05 | 移动端：幻灯片播放，支持自动/手动、过渡、循环与控件 | P0     | ✅   | 移动端     |

---

### 4.4 操作日志（全平台已实现）

**概述**：记录并展示应用内关键用户操作，便于审计与回溯。三端共用同一类型与业务逻辑（`packages/common`：`types/log`、`OperationLogService`），仅存储适配器不同（Web/桌面：localStorage；移动端：AsyncStorage）。Web/桌面入口：顶部栏与 Ctrl+Shift+L 快捷键；移动端入口：设置 →「操作日志」菜单，弹窗展示最近 10 条，支持导出 JSON/CSV 与清空。

| ID       | 需求                                                            | 优先级 | 状态 | 平台                               |
| -------- | --------------------------------------------------------------- | ------ | ---- | ---------------------------------- |
| F-LOG-01 | 记录上传、删除、编辑、配置变更、批量上传等操作                  | P1     | ✅   | 全平台                             |
| F-LOG-02 | 提供日志查看界面（弹窗/独立页），支持按类型、时间、关键词等筛选 | P1     | ✅   | Web/桌面；移动端弹窗展示最近 10 条 |
| F-LOG-03 | 展示统计（如按类型操作数、今日数量、成功率）                    | P2     | ✅   | 全平台                             |
| F-LOG-04 | 支持将日志导出为 JSON/CSV 文件                                  | P2     | ✅   | 全平台（移动端通过系统分享）       |
| F-LOG-05 | 移动端实现与 Web/桌面等效的日志能力                             | P2     | ✅   | 移动端                             |

---

### 4.5 PWA 与离线（Web 已实现）

**概述**：Web 以 PWA 形式提供离线与「可安装」体验。

| ID       | 需求                                | 优先级 | 状态           | 平台 |
| -------- | ----------------------------------- | ------ | -------------- | ---- |
| F-PWA-01 | Service Worker 注册与离线缓存       | P1     | ✅             | Web  |
| F-PWA-02 | 安装提示（PWAInstallPrompt）        | P1     | ✅             | Web  |
| F-PWA-03 | 离线状态指示（如 OfflineIndicator） | P1     | ✅             | Web  |
| F-PWA-04 | PWA 更新检测与提示                  | P2     | ⏳ 待修复/完善 | Web  |

---

### 4.6 图片处理工具（部分实现）

**概述**：提供压缩、格式转换、编辑、分析与生成能力；各平台进度不一。

#### 4.6.1 格式转换

| ID            | 需求                                | 优先级 | 状态                  | 平台       |
| ------------- | ----------------------------------- | ------ | --------------------- | ---------- |
| F-TOOL-CVT-01 | 支持 JPEG、PNG、WebP 等格式间转换   | P0     | ⏳ 页面就绪，逻辑待补 | Web / 桌面 |
| F-TOOL-CVT-02 | 移动端：已支持 JPEG、PNG、WebP 转换 | P0     | ✅                    | 移动端     |

#### 4.6.2 图片压缩

| ID            | 需求                                  | 优先级 | 状态                  | 平台       |
| ------------- | ------------------------------------- | ------ | --------------------- | ---------- |
| F-TOOL-CMP-01 | 可调压缩质量（如 10%–100%），实时预览 | P0     | ⏳ 页面就绪，逻辑待补 | Web / 桌面 |
| F-TOOL-CMP-02 | 移动端：已实现可调质量压缩            | P0     | ✅                    | 移动端     |

#### 4.6.3 图片编辑

| ID            | 需求                                 | 优先级 | 状态                  | 平台       |
| ------------- | ------------------------------------ | ------ | --------------------- | ---------- |
| F-TOOL-EDT-01 | 裁剪、缩放、元数据编辑               | P0     | ⏳ 页面就绪，逻辑待补 | Web / 桌面 |
| F-TOOL-EDT-02 | 移动端：已支持裁剪、缩放、元数据编辑 | P0     | ✅ 部分               | 移动端     |

#### 4.6.4 图片分析

| ID            | 需求                                                         | 优先级 | 状态                  | 平台                |
| ------------- | ------------------------------------------------------------ | ------ | --------------------- | ------------------- |
| F-TOOL-ANZ-01 | 基础信息（尺寸、格式、通道等）与扩展分析（如标签与描述生成） | P1     | ⏳ 页面就绪，逻辑待补 | Web / 桌面 / 移动端 |

#### 4.6.5 图片生成

| ID            | 需求                                       | 优先级 | 状态      | 平台   |
| ------------- | ------------------------------------------ | ------ | --------- | ------ |
| F-TOOL-GEN-01 | 基于文本或条件生成图片（含未来 Dify 集成） | P2     | ⏳ 规划中 | 全平台 |

---

### 4.7 搜索与筛选（部分实现）

**概述**：通过关键词与筛选条件缩小图片范围。

| ID          | 需求                           | 优先级 | 状态                                        | 平台       |
| ----------- | ------------------------------ | ------ | ------------------------------------------- | ---------- |
| F-SEARCH-01 | 按名称、描述、标签搜索         | P0     | ✅（如 Photos 页与 SearchContext）          | Web / 桌面 |
| F-SEARCH-02 | 按标签、尺寸、日期等筛选       | P1     | ✅（如 filterImages、createDefaultFilters） | Web / 桌面 |
| F-SEARCH-03 | 移动端：已支持搜索与多维度筛选 | P1     | ✅                                          | 移动端     |
| F-SEARCH-04 | 多条件组合、搜索历史与高级搜索 | P2     | ⏳ 待实现                                   | 全平台     |

---

### 4.8 国际化与主题（已实现）

| ID         | 需求                           | 优先级 | 状态                                     | 平台          |
| ---------- | ------------------------------ | ------ | ---------------------------------------- | ------------- |
| F-I18N-01  | 中英文切换，界面文案随语言变化 | P0     | ✅                                       | 全平台        |
| F-THEME-01 | 亮色/暗色主题切换              | P1     | ✅（如移动端）；Web/桌面可按当前实现标注 | 部分 / 全平台 |

---

### 4.9 快捷键与帮助（已实现）

| ID       | 需求                                                                                                              | 优先级 | 状态 | 平台       |
| -------- | ----------------------------------------------------------------------------------------------------------------- | ------ | ---- | ---------- |
| F-KBD-01 | 常用操作支持快捷键（Esc 关闭弹窗、F1 帮助、F5 刷新、Ctrl+, 配置、/ 搜索框、Ctrl+V 查看、Ctrl+Shift+L 操作日志等） | P1     | ✅   | Web / 桌面 |
| F-KBD-02 | 提供快捷键帮助弹窗（KeyboardHelpModal），按 F1 打开                                                               | P2     | ✅   | Web / 桌面 |

---

### 4.10 Web/桌面扩展（部分实现 / 规划）

**概述**：Web 与桌面端的增强功能与体验优化。

| ID            | 需求                                                        | 优先级 | 状态      | 平台       |
| ------------- | ----------------------------------------------------------- | ------ | --------- | ---------- |
| F-WEB-DESK-01 | 批量编辑元数据（标签、描述、名称）                          | P1     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-02 | 网格布局优化（列数切换、瀑布流、列表视图）                  | P1     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-03 | 加载体验优化（骨架屏、懒加载优化、预加载）                  | P1     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-04 | 私有仓库图片访问控制（自动识别仓库类型、基于 Token 的访问） | P1     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-05 | 错误处理增强（重试机制、清晰错误提示、错误恢复）            | P1     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-06 | 桌面离线支持（离线浏览、上传队列、网络状态检测）            | P1     | ⏳ 待实现 | 桌面       |
| F-WEB-DESK-07 | Web 触屏手势支持（长按菜单、滑动操作）                      | P2     | ⏳ 待实现 | Web        |
| F-WEB-DESK-08 | AI 能力集成（自动打标签、场景识别、OCR、目标检测）          | P2     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-09 | 收藏与分组（收藏、自定义相册、标签管理）                    | P2     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-10 | 统计与洞察（存储用量、图片数量、上传历史、操作统计）        | P2     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-11 | 快捷操作（最近上传、常用标签、快速上传模板）                | P2     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-12 | 动画与过渡（页面过渡、加载动画、反馈动画）                  | P2     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-13 | 无障碍支持（读屏、键盘导航、字号、高对比度）                | P2     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-14 | 性能优化（图片缓存策略、虚拟列表、压缩图缓存）              | P2     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-15 | 分享与协作（分享链接、二维码生成、多用户编辑）              | P2     | ⏳ 待实现 | Web / 桌面 |
| F-WEB-DESK-16 | 桌面自动更新（electron-updater、检查/下载/安装）            | P1     | ⏳ 待实现 | 桌面       |
| F-WEB-DESK-17 | 桌面系统托盘（托盘图标、托盘菜单、最小化到托盘、托盘通知）  | P1     | ⏳ 待实现 | 桌面       |

---

### 4.11 移动端扩展（部分实现 / 规划）

**概述**：基于移动端能力的移动专属功能与增强。

| ID          | 需求                                                        | 优先级 | 状态        | 平台   |
| ----------- | ----------------------------------------------------------- | ------ | ----------- | ------ |
| F-MOBILE-01 | 批量上传及进度与错误处理                                    | P0     | ✅          | 移动端 |
| F-MOBILE-02 | 多张图片批量编辑元数据（标签、描述、名称）                  | P0     | ⏳ 高优先级 | 移动端 |
| F-MOBILE-03 | 网格布局优化（2/3/4 列、瀑布流、列表视图）                  | P1     | ⏳ 中优先级 | 移动端 |
| F-MOBILE-04 | 加载体验优化（骨架屏、懒加载、预加载）                      | P1     | ⏳ 中优先级 | 移动端 |
| F-MOBILE-05 | 私有仓库图片访问控制（自动识别仓库类型、基于 Token 的访问） | P1     | ⏳ 中优先级 | 移动端 |
| F-MOBILE-06 | 错误处理增强（重试机制、清晰错误提示）                      | P1     | ⏳ 中优先级 | 移动端 |
| F-MOBILE-07 | 离线支持（离线浏览、上传队列、网络状态检测）                | P1     | ⏳ 中优先级 | 移动端 |
| F-MOBILE-08 | 手势增强（长按菜单、滑动删除、双击缩放）                    | P1     | ⏳ 中优先级 | 移动端 |
| F-MOBILE-09 | AI 能力集成（自动打标签、场景识别、OCR、目标检测）          | P2     | ⏳ 低优先级 | 移动端 |
| F-MOBILE-10 | 收藏与分组（收藏、自定义相册、标签管理）                    | P2     | ⏳ 低优先级 | 移动端 |
| F-MOBILE-11 | 统计与洞察（存储用量、图片数量、上传历史）                  | P2     | ⏳ 低优先级 | 移动端 |
| F-MOBILE-12 | 快捷操作（最近上传、常用标签、快速上传）                    | P2     | ⏳ 低优先级 | 移动端 |
| F-MOBILE-13 | 动画与过渡（页面过渡、加载动画、反馈动画）                  | P2     | ⏳ 低优先级 | 移动端 |
| F-MOBILE-14 | 无障碍支持（读屏、键盘导航、字号）                          | P2     | ⏳ 低优先级 | 移动端 |
| F-MOBILE-15 | 性能优化（图片缓存、虚拟列表、压缩图缓存）                  | P2     | ⏳ 低优先级 | 移动端 |
| F-MOBILE-16 | 分享与协作（分享链接、二维码、多用户编辑）                  | P2     | ⏳ 低优先级 | 移动端 |

---

### 4.12 服务端功能（规划中 / 开发中）

**概述**：可选后端服务（Pixuli Server）提供 MCP
Server、图片仓库管理、认证与高级能力等。

#### 4.12.1 核心功能（高优先级）

| ID          | 需求                                                                           | 优先级 | 状态        | 平台   |
| ----------- | ------------------------------------------------------------------------------ | ------ | ----------- | ------ |
| F-SERVER-01 | MCP Server 核心（Model Context Protocol 支持、模型管理、上下文管理、模型交互） | P0     | ⏳ 高优先级 | 服务端 |
| F-SERVER-02 | 图片仓库核心（图片存储管理、元数据管理、版本控制、RESTful API）                | P0     | ⏳ 高优先级 | 服务端 |
| F-SERVER-03 | 认证与授权（JWT 认证、RBAC、安全策略、限流）                                   | P0     | ⏳ 高优先级 | 服务端 |

#### 4.12.2 增强功能（中优先级）

| ID          | 需求                                                                 | 优先级 | 状态        | 平台   |
| ----------- | -------------------------------------------------------------------- | ------ | ----------- | ------ |
| F-SERVER-04 | 智能搜索（基于 AI 的图片搜索、Elasticsearch 全文搜索、搜索性能优化） | P1     | ⏳ 中优先级 | 服务端 |
| F-SERVER-05 | 批量处理（批量上传、批量操作、Bull/BullMQ 任务队列）                 | P1     | ⏳ 中优先级 | 服务端 |
| F-SERVER-06 | 缓存与性能优化（Redis 缓存、数据库优化、CDN 集成）                   | P1     | ⏳ 中优先级 | 服务端 |
| F-SERVER-07 | 监控与日志（Prometheus 指标、Winston 日志、Grafana 看板）            | P1     | ⏳ 中优先级 | 服务端 |
| F-SERVER-08 | 错误处理与容错（统一错误响应、重试、熔断、Sentry 集成）              | P1     | ⏳ 中优先级 | 服务端 |

#### 4.12.3 扩展功能（低优先级）

| ID          | 需求                                                        | 优先级 | 状态        | 平台   |
| ----------- | ----------------------------------------------------------- | ------ | ----------- | ------ |
| F-SERVER-09 | 图片处理服务集成（压缩、格式转换、缩放、裁剪）              | P2     | ⏳ 低优先级 | 服务端 |
| F-SERVER-10 | Webhook 与事件（Webhook 注册、事件发布/订阅、事件历史）     | P2     | ⏳ 低优先级 | 服务端 |
| F-SERVER-11 | 数据导入/导出（元数据导出/导入、批量操作、任务管理）        | P2     | ⏳ 低优先级 | 服务端 |
| F-SERVER-12 | 多租户（租户管理、资源隔离、计费与统计）                    | P2     | ⏳ 低优先级 | 服务端 |
| F-SERVER-13 | API 限流与配额（按 IP/用户/接口限流、存储/请求配额）        | P2     | ⏳ 低优先级 | 服务端 |
| F-SERVER-14 | 文档与测试（Swagger/OpenAPI 文档、测试覆盖率 >80%）         | P2     | ⏳ 低优先级 | 服务端 |
| F-SERVER-15 | 国际化（多语言错误信息、时区支持）                          | P2     | ⏳ 低优先级 | 服务端 |
| F-SERVER-16 | GraphQL API（GraphQL Schema、查询/变更/订阅，与 REST 并存） | P2     | ⏳ 低优先级 | 服务端 |

---

## 五、非功能需求

### 5.1 性能

| ID         | 需求                                                              | 说明                                 |
| ---------- | ----------------------------------------------------------------- | ------------------------------------ |
| NF-PERF-01 | 多图场景下列表渲染应可接受（如懒加载、分页或虚拟滚动）            | 当前已有懒加载等；虚拟滚动为待优化项 |
| NF-PERF-02 | Web/桌面端图片处理（压缩、转换）优先采用 WASM，控制首包与运行内存 | 参见 packages/wasm 与设计文档        |
| NF-PERF-03 | 移动端可实现元数据缓存以减少重复请求                              | 部分已实现                           |

### 5.2 安全与隐私

| ID        | 需求                                                                |
| --------- | ------------------------------------------------------------------- |
| NF-SEC-01 | GitHub/Gitee Token 仅存储在用户设备本地，不上传至用户不可控的服务器 |
| NF-SEC-02 | 若使用自托管 Server，支持 API Key 认证（见服务端文档）              |

### 5.3 兼容性

| ID           | 需求                                                                    |
| ------------ | ----------------------------------------------------------------------- |
| NF-COMPAT-01 | Web：现代浏览器（Chrome、Firefox、Safari、Edge 等）；需支持 WASM 的环境 |
| NF-COMPAT-02 | 桌面：Windows 10/11 x64；macOS 10.15+（x64/ARM64）                      |
| NF-COMPAT-03 | 移动端：Android 5.0+（API 21）；iOS 待定                                |

### 5.4 可用性与可维护性

| ID          | 需求                                                                                                          |
| ----------- | ------------------------------------------------------------------------------------------------------------- |
| NF-USAB-01  | 主流程支持中英双语，关键操作有反馈（如 Toast、加载状态）                                                      |
| NF-MAINT-01 | 通用逻辑与 UI 集中在 packages/common 供各平台复用，便于维护与体验一致（含操作日志类型与服务在 common 中统一） |

---

## 六、与可选后端（Pixuli Server）的集成

Pixuli 前端默认以 **GitHub / Gitee** 为存储，不依赖自托管后端。**Pixuli Server**
为可选后端服务，可提供以下增强能力：

- **MCP Server**：Model Context Protocol，支持 AI 模型集成
- **图片仓库**：带版本控制的高级图片存储与管理
- **认证与授权**：基于 JWT 的认证与 RBAC
- **智能搜索**：基于 AI 的图片搜索与全文搜索
- **批量处理**：大规模图片处理的任务队列
- **监控与日志**：监控与日志能力

### 6.1 服务端能力概览

**当前实现**（参见 `server/README.md`）：

- 图片上传、列表、详情、元数据更新、删除
- 本地存储与 MinIO 对象存储
- API Key 认证
- 标签与简单查询

**规划功能**（详见 4.12 节）：

- MCP Server 核心
- 带版本控制的图片仓库增强
- 完整认证与授权体系
- 基于 Elasticsearch 的智能搜索
- 任务队列批量处理
- 缓存与性能优化
- 监控与日志体系

### 6.2 前端-服务端集成要求（启用时）

- 使用 Server 提供的 REST API（如
  `/api/images/*`）进行上传、列表、删除、元数据更新。
- 通过环境变量或配置在「仓库源」与「Server 源」之间切换，前端抽象为「当前图床源」。
- 未来支持 GraphQL API（实现后）与 REST 并存。
- 与 MCP Server 集成以支持 AI 能力（可用时）。

---

## 七、需求优先级

- **P0**：核心流程；缺失则产品不可用或体验严重受损。
- **P1**：重要功能，影响体验与差异化。
- **P2**：增强功能，可后续迭代。

---

## 八、附录

### 8.1 相关文档

- [项目 README](https://github.com/trueLoving/Pixuli/blob/main/README.md)
- [Pixuli 应用文档](https://github.com/trueLoving/Pixuli/blob/main/apps/pixuli/README.md)
- [移动端文档](https://github.com/trueLoving/Pixuli/blob/main/apps/mobile/README.md)
- [服务端文档](https://github.com/trueLoving/Pixuli/blob/main/server/README.md)
- [Common 包文档](https://github.com/trueLoving/Pixuli/blob/main/packages/common/README.md)
- [WASM 包文档](https://github.com/trueLoving/Pixuli/blob/main/packages/wasm/README.md)

### 8.2 修订历史

| 版本 | 日期       | 变更                                                                                                                                                                                                  | 作者 |
| ---- | ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---- |
| 1.0  | 2025-01-27 | 初稿，基于仓库代码与文档                                                                                                                                                                              | —    |
| 1.1  | 2025-01-28 | 与实现同步：操作日志 Web/桌面已实现                                                                                                                                                                   | —    |
| 1.2  | 2025-01-29 | 根据移动端与服务端路线图更新：移动端批量上传/编辑状态、移动端幻灯片、服务端功能（MCP、仓库、认证等）                                                                                                  | —    |
| 1.3  | 2025-01-29 | 扩展需求：将适合 Web/桌面的移动端扩展能力纳入需求规划（批量编辑、布局优化、加载优化、私有仓库、错误处理、离线、AI、收藏/分组、统计、快捷操作、动画、无障碍、性能优化、分享协作等）                    | —    |
| 1.4  | 2025-01-29 | 与实现同步：移动端操作日志已实现（设置 →「操作日志」，弹窗最近 10 条，导出 JSON/CSV、清空）；操作日志类型与服务统一至 packages/common（OperationLogService + 存储适配器）；移动端批量上传标记为已实现 | —    |

---

_本文档随项目迭代更新，请以代码与最新设计文档为准。_
